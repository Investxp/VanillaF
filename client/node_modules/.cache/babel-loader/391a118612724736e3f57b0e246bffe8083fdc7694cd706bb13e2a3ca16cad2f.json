{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Typography,Container,Box,TextField,Button,List,ListItem,ListItemText,Alert}from'@mui/material';import{getDomains,addDomain}from'../apiDomains';// Helper to parse token from URL\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function getTokenFromUrl(){const params=new URLSearchParams(window.location.search);return params.get('token');}const Dashboard=()=>{const[domains,setDomains]=useState([]);const[newDomain,setNewDomain]=useState('');const[error,setError]=useState('');const[success,setSuccess]=useState('');const[loading,setLoading]=useState(false);const fetchDomains=async()=>{setError('');try{const token=localStorage.getItem('token');const data=await getDomains(token);setDomains(data);}catch(err){setError('Could not fetch domains.');}};useEffect(()=>{// If redirected from Google OAuth, store token\nconst urlToken=getTokenFromUrl();if(urlToken){localStorage.setItem('token',urlToken);window.history.replaceState({},document.title,'/dashboard');}fetchDomains();},[]);const handleAddDomain=async e=>{e.preventDefault();setError('');setSuccess('');setLoading(true);try{const token=localStorage.getItem('token');await addDomain(newDomain,token);setSuccess('Domain added!');setNewDomain('');fetchDomains();}catch(err){setError('Failed to add domain.');}finally{setLoading(false);}};// Delete domain handler\nconst handleDelete=async id=>{setError('');setSuccess('');setLoading(true);try{const token=localStorage.getItem('token');const res=await fetch(\"\".concat(process.env.REACT_APP_API_URL||'https://server-production-aebe.up.railway.app',\"/api/domains/\").concat(id),{// Update here if server URL changes\nmethod:'DELETE',headers:{'Authorization':\"Bearer \".concat(token)}});if(!res.ok)throw new Error('Failed to delete domain');setSuccess('Domain deleted!');fetchDomains();}catch(_unused){setError('Failed to delete domain.');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",sx:{mt:4},children:\"Dashboard\"}),/*#__PURE__*/_jsx(Typography,{sx:{mt:2},children:\"Manage your domains and sites here.\"}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mt:2},children:error}),success&&/*#__PURE__*/_jsx(Alert,{severity:\"success\",sx:{mt:2},children:success}),/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:handleAddDomain,sx:{mt:4,display:'flex',gap:2},children:[/*#__PURE__*/_jsx(TextField,{label:\"New Domain\",value:newDomain,onChange:e=>setNewDomain(e.target.value),required:true}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",disabled:loading,children:loading?'Adding...':'Add Domain'})]}),/*#__PURE__*/_jsx(List,{sx:{mt:4},children:domains.map(domain=>/*#__PURE__*/_jsx(ListItem,{secondaryAction:/*#__PURE__*/_jsx(Button,{color:\"error\",onClick:()=>handleDelete(domain._id||domain.id),children:\"Delete\"}),children:/*#__PURE__*/_jsx(ListItemText,{primary:domain.name})},domain.id||domain._id))})]});};export default Dashboard;","map":{"version":3,"names":["React","useEffect","useState","Typography","Container","Box","TextField","Button","List","ListItem","ListItemText","Alert","getDomains","addDomain","jsx","_jsx","jsxs","_jsxs","getTokenFromUrl","params","URLSearchParams","window","location","search","get","Dashboard","domains","setDomains","newDomain","setNewDomain","error","setError","success","setSuccess","loading","setLoading","fetchDomains","token","localStorage","getItem","data","err","urlToken","setItem","history","replaceState","document","title","handleAddDomain","e","preventDefault","handleDelete","id","res","fetch","concat","process","env","REACT_APP_API_URL","method","headers","ok","Error","_unused","maxWidth","children","variant","sx","mt","severity","component","onSubmit","display","gap","label","value","onChange","target","required","type","disabled","map","domain","secondaryAction","color","onClick","_id","primary","name"],"sources":["C:/Users/Investpal/OneDrive/Desktop/VANILLA F/client/src/pages/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Typography, Container, Box, TextField, Button, List, ListItem, ListItemText, Alert } from '@mui/material';\r\nimport { getDomains, addDomain } from '../apiDomains';\r\n// Helper to parse token from URL\r\nfunction getTokenFromUrl() {\r\n  const params = new URLSearchParams(window.location.search);\r\n  return params.get('token');\r\n}\r\n\r\nconst Dashboard = () => {\r\n  const [domains, setDomains] = useState([]);\r\n  const [newDomain, setNewDomain] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const fetchDomains = async () => {\r\n    setError('');\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const data = await getDomains(token);\r\n      setDomains(data);\r\n    } catch (err) {\r\n      setError('Could not fetch domains.');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    // If redirected from Google OAuth, store token\r\n    const urlToken = getTokenFromUrl();\r\n    if (urlToken) {\r\n      localStorage.setItem('token', urlToken);\r\n      window.history.replaceState({}, document.title, '/dashboard');\r\n    }\r\n    fetchDomains();\r\n  }, []);\r\n\r\n  const handleAddDomain = async (e) => {\r\n    e.preventDefault();\r\n    setError('');\r\n    setSuccess('');\r\n    setLoading(true);\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      await addDomain(newDomain, token);\r\n      setSuccess('Domain added!');\r\n      setNewDomain('');\r\n      fetchDomains();\r\n    } catch (err) {\r\n      setError('Failed to add domain.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Delete domain handler\r\n  const handleDelete = async (id) => {\r\n    setError('');\r\n    setSuccess('');\r\n    setLoading(true);\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const res = await fetch(`${process.env.REACT_APP_API_URL || 'https://server-production-aebe.up.railway.app'}/api/domains/${id}`, { // Update here if server URL changes\r\n        method: 'DELETE',\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n      if (!res.ok) throw new Error('Failed to delete domain');\r\n      setSuccess('Domain deleted!');\r\n      fetchDomains();\r\n    } catch {\r\n      setError('Failed to delete domain.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container maxWidth=\"md\">\r\n      <Typography variant=\"h4\" sx={{ mt: 4 }}>Dashboard</Typography>\r\n      <Typography sx={{ mt: 2 }}>Manage your domains and sites here.</Typography>\r\n      {error && <Alert severity=\"error\" sx={{ mt: 2 }}>{error}</Alert>}\r\n      {success && <Alert severity=\"success\" sx={{ mt: 2 }}>{success}</Alert>}\r\n      <Box component=\"form\" onSubmit={handleAddDomain} sx={{ mt: 4, display: 'flex', gap: 2 }}>\r\n        <TextField label=\"New Domain\" value={newDomain} onChange={e => setNewDomain(e.target.value)} required />\r\n        <Button type=\"submit\" variant=\"contained\" disabled={loading}>{loading ? 'Adding...' : 'Add Domain'}</Button>\r\n      </Box>\r\n      <List sx={{ mt: 4 }}>\r\n        {domains.map(domain => (\r\n          <ListItem key={domain.id || domain._id} secondaryAction={\r\n            <Button color=\"error\" onClick={() => handleDelete(domain._id || domain.id)}>Delete</Button>\r\n          }>\r\n            <ListItemText primary={domain.name} />\r\n          </ListItem>\r\n        ))}\r\n      </List>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}